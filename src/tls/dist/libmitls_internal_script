# This version script is used on CI because the test needs access to internal
# functions and helpers. We hide whatever will for sure cause a conflict with
# the symbols defined in the test driver (we now do separate compilation for the
# test driver and library). Note that we IGNORE the kremlin-generated .def file
# since it contains too much (all the __eq__* monomorphizations). Eliminating
# FStar and Prims ensures that libmitls.dll does not export more than it needs
# -- F* clients doing separate compilation might have trouble linking against it
# on Windows otherwise.
#
# I haven't found a way to check the effects of the version script using the
# Windows/MinGW toolchain. The `nm` tool always shows T even though when linking
# the test against libmitls.dll.a, visibility seems consistent with the contents
# of the version script. Windows tools like DLL explorer seem to display
# consistent results, at the expense of having to use a GUI tool.
LIBMITLS_0.1 {
    global:
      *;
    local:
      kremlinit_globals;
      __eq__*;
      __neq__*;
      FStar_*;
      Prims_*;
};
